(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[648],{905:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>o});var s=l(5155),a=l(2115),n=l(3462);function o(){let[e,t]=(0,a.useState)([]),[l,o]=(0,a.useState)(""),[c,r]=(0,a.useState)(null);(0,a.useEffect)(()=>{let e=(0,n.gf)();if(e)try{let l=JSON.parse(atob(e.split(".")[1]));r(l.email),fetch("".concat("http://localhost:5000/api","/invoices/seller/").concat(encodeURIComponent(l.email))).then(e=>e.json()).then(e=>t(e))}catch(e){r(null)}},[]);let i=async()=>{var t,l;if(o("Sending..."),!e.length)return o("No invoices to email.");let s=(null==(t=e[0])?void 0:t.auctionTitle)||(null==(l=e[0])?void 0:l.auctionId);if(!s)return o("No auction ID found.");try{let e=await fetch("".concat("http://localhost:5000/api","/invoices/email-invoices/").concat(encodeURIComponent(s)),{method:"POST"}),t=await e.json();e.ok?o("✅ Invoice(s) emailed!"):o("❌ ".concat(t.error||"Failed to email invoices."))}catch(e){o("❌ Failed to email invoices.")}};return(0,s.jsxs)("main",{className:"p-6 max-w-5xl mx-auto",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-yellow-700 mb-6",children:"\uD83D\uDCE6 My Sold Items"}),0===e.length?(0,s.jsx)("p",{className:"text-gray-600",children:"Loading sales data..."}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex gap-4 mb-4",children:[(0,s.jsx)("button",{onClick:()=>{c&&window.open("".concat("http://localhost:5000/api","/invoices/seller/").concat(encodeURIComponent(c),"/pdf"),"_blank")},className:"bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-4 rounded",children:"Download PDF"}),(0,s.jsx)("button",{onClick:i,className:"bg-green-500 hover:bg-green-600 text-white font-semibold py-2 px-4 rounded",children:"Email Me My Invoices"}),l&&(0,s.jsx)("span",{className:"ml-2 text-sm text-blue-700",children:l})]}),(0,s.jsxs)("table",{className:"w-full border-collapse text-sm shadow",children:[(0,s.jsx)("thead",{className:"bg-yellow-100 text-gray-800",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"border px-3 py-2",children:"Sale ID"}),(0,s.jsx)("th",{className:"border px-3 py-2",children:"Auction"}),(0,s.jsx)("th",{className:"border px-3 py-2",children:"Lot #"}),(0,s.jsx)("th",{className:"border px-3 py-2",children:"Item"}),(0,s.jsx)("th",{className:"border px-3 py-2",children:"Amount (R)"}),(0,s.jsx)("th",{className:"border px-3 py-2",children:"Buyer"}),(0,s.jsx)("th",{className:"border px-3 py-2",children:"Date"})]})}),(0,s.jsx)("tbody",{children:e.map(e=>(0,s.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,s.jsx)("td",{className:"border px-3 py-2",children:e.id}),(0,s.jsx)("td",{className:"border px-3 py-2",children:e.auctionTitle}),(0,s.jsx)("td",{className:"border px-3 py-2",children:e.lotNumber}),(0,s.jsx)("td",{className:"border px-3 py-2",children:e.item}),(0,s.jsxs)("td",{className:"border px-3 py-2 font-semibold",children:["R",e.amount]}),(0,s.jsx)("td",{className:"border px-3 py-2",children:e.buyer||e.buyerEmail||"-"}),(0,s.jsx)("td",{className:"border px-3 py-2",children:e.date})]},e.id))})]})]})]})}},2259:(e,t,l)=>{Promise.resolve().then(l.bind(l,905))},3462:(e,t,l)=>{"use strict";function s(e){localStorage.setItem("jwt_token",e)}function a(){return localStorage.getItem("jwt_token")}l.d(t,{WG:()=>s,gf:()=>a})}},e=>{e.O(0,[441,964,358],()=>e(e.s=2259)),_N_E=e.O()}]);