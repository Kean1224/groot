(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[690],{3462:(e,t,s)=>{"use strict";function l(e){localStorage.setItem("jwt_token",e)}function a(){return localStorage.getItem("jwt_token")}s.d(t,{WG:()=>l,gf:()=>a})},4605:(e,t,s)=>{Promise.resolve().then(s.bind(s,5417))},5417:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var l=s(5155),a=s(2115),n=s(3462);function o(){let[e,t]=(0,a.useState)([]),[s,o]=(0,a.useState)(""),[c,i]=(0,a.useState)(null);(0,a.useEffect)(()=>{let e=(0,n.gf)();if(e)try{let s=JSON.parse(atob(e.split(".")[1]));i(s.email),fetch("".concat("http://localhost:5000/api","/invoices/buyer/").concat(encodeURIComponent(s.email))).then(e=>e.json()).then(e=>t(e))}catch(e){i(null)}},[]);let r=async()=>{var t,s;if(o("Sending..."),!e.length)return o("No invoices to email.");let l=(null==(t=e[0])?void 0:t.auctionTitle)||(null==(s=e[0])?void 0:s.auctionId);if(!l)return o("No auction ID found.");try{let e=await fetch("".concat("http://localhost:5000/api","/invoices/email-invoices/").concat(encodeURIComponent(l)),{method:"POST"}),t=await e.json();e.ok?o("✅ Invoice(s) emailed!"):o("❌ ".concat(t.error||"Failed to email invoices."))}catch(e){o("❌ Failed to email invoices.")}};return(0,l.jsxs)("main",{className:"p-6 max-w-4xl mx-auto",children:[(0,l.jsx)("h1",{className:"text-3xl font-bold text-yellow-700 mb-6",children:"\uD83E\uDDFE My Purchased Invoices"}),0===e.length?(0,l.jsx)("p",{className:"text-gray-600",children:"Loading invoices..."}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"flex gap-4 mb-4",children:[(0,l.jsx)("button",{onClick:()=>{c&&window.open("".concat("http://localhost:5000/api","/invoices/buyer/").concat(encodeURIComponent(c),"/pdf"),"_blank")},className:"bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-4 rounded",children:"Download PDF"}),(0,l.jsx)("button",{onClick:r,className:"bg-green-500 hover:bg-green-600 text-white font-semibold py-2 px-4 rounded",children:"Email Me My Invoices"}),s&&(0,l.jsx)("span",{className:"ml-2 text-sm text-blue-700",children:s})]}),(0,l.jsxs)("table",{className:"w-full border-collapse text-sm shadow",children:[(0,l.jsx)("thead",{className:"bg-yellow-100 text-gray-800",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"border px-3 py-2",children:"Invoice ID"}),(0,l.jsx)("th",{className:"border px-3 py-2",children:"Auction"}),(0,l.jsx)("th",{className:"border px-3 py-2",children:"Lot #"}),(0,l.jsx)("th",{className:"border px-3 py-2",children:"Item"}),(0,l.jsx)("th",{className:"border px-3 py-2",children:"Amount (R)"}),(0,l.jsx)("th",{className:"border px-3 py-2",children:"Date"})]})}),(0,l.jsx)("tbody",{children:e.map(e=>(0,l.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,l.jsx)("td",{className:"border px-3 py-2",children:e.id}),(0,l.jsx)("td",{className:"border px-3 py-2",children:e.auctionTitle}),(0,l.jsx)("td",{className:"border px-3 py-2",children:e.lotNumber}),(0,l.jsx)("td",{className:"border px-3 py-2",children:e.item}),(0,l.jsxs)("td",{className:"border px-3 py-2 font-semibold",children:["R",e.amount]}),(0,l.jsx)("td",{className:"border px-3 py-2",children:e.date})]},e.id))})]})]})]})}}},e=>{e.O(0,[441,964,358],()=>e(e.s=4605)),_N_E=e.O()}]);