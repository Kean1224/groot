(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[419],{2572:(e,s,a)=>{"use strict";a.d(s,{A:()=>d});var l=a(5155),t=a(6874),i=a.n(t),r=a(5695);let n=[{href:"/admin/dashboard",label:"Dashboard"},{href:"/admin/auctions",label:"Auctions"},{href:"/admin/lots",label:"Lots"},{href:"/admin/users",label:"Users"},{href:"/admin/invoices",label:"Invoices"},{href:"/admin/assign-seller",label:"Assign Seller"}];function d(){let e=(0,r.usePathname)();return(0,l.jsxs)("aside",{className:"bg-yellow-100 border-r border-yellow-300 min-h-screen w-56 p-6 flex flex-col gap-4 sticky top-0",children:[(0,l.jsx)("h2",{className:"text-lg font-bold text-yellow-700 mb-4",children:"Admin Panel"}),(0,l.jsx)("nav",{className:"flex flex-col gap-2",children:n.map(s=>(0,l.jsx)(i(),{href:s.href,className:"px-3 py-2 rounded font-semibold transition-all text-yellow-800 hover:bg-yellow-200 ".concat(e===s.href?"bg-yellow-300":""),children:s.label},s.href))})]})}},5695:(e,s,a)=>{"use strict";var l=a(8999);a.o(l,"useParams")&&a.d(s,{useParams:function(){return l.useParams}}),a.o(l,"usePathname")&&a.d(s,{usePathname:function(){return l.usePathname}}),a.o(l,"useRouter")&&a.d(s,{useRouter:function(){return l.useRouter}}),a.o(l,"useSearchParams")&&a.d(s,{useSearchParams:function(){return l.useSearchParams}})},5704:(e,s,a)=>{Promise.resolve().then(a.bind(a,7146))},7146:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>r});var l=a(5155),t=a(2115),i=a(2572);let r=function(){let[e,s]=(0,t.useState)([]),[a,r]=(0,t.useState)(""),[n,d]=(0,t.useState)([]),[c,o]=(0,t.useState)(null);(0,t.useEffect)(()=>{h()},[]);let h=async()=>{try{let e=await fetch("".concat("http://localhost:5000/api","/invoices")),a=(await e.json()).map(e=>{var s;return{...e,paid:null!=(s=e.paid)&&s}});s(a),d(a)}catch(e){console.error("Failed to fetch invoices:",e)}};return(0,l.jsxs)("div",{className:"flex min-h-screen",children:[(0,l.jsx)(i.A,{}),(0,l.jsx)("main",{className:"flex-1 px-8 py-8 bg-white",children:(0,l.jsxs)("div",{className:"p-6 max-w-6xl mx-auto",children:[(0,l.jsx)("h1",{className:"text-3xl font-bold text-yellow-600 mb-6",children:"Invoice Overview"}),(0,l.jsxs)("div",{className:"flex gap-4 mb-6",children:[(0,l.jsx)("input",{type:"text",placeholder:"Search by buyer or seller email...",value:a,onChange:e=>r(e.target.value),className:"border px-4 py-2 w-full rounded"}),(0,l.jsx)("button",{onClick:()=>{let s=a.trim().toLowerCase();if(!s)return d(e);d(e.filter(e=>e.buyerEmail.toLowerCase().includes(s)||e.sellerEmail.toLowerCase().includes(s)))},className:"bg-yellow-500 text-white px-4 py-2 rounded hover:bg-yellow-600",children:"Filter"})]}),(0,l.jsx)("div",{className:"overflow-auto bg-white p-4 rounded shadow",children:(0,l.jsxs)("table",{className:"w-full text-sm text-left border",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{className:"bg-gray-100 text-xs uppercase text-gray-600",children:[(0,l.jsx)("th",{className:"p-2",children:"Auction"}),(0,l.jsx)("th",{className:"p-2",children:"Lot"}),(0,l.jsx)("th",{className:"p-2",children:"Item"}),(0,l.jsx)("th",{className:"p-2",children:"Buyer Total"}),(0,l.jsx)("th",{className:"p-2",children:"Buyer"}),(0,l.jsx)("th",{className:"p-2",children:"Seller"}),(0,l.jsx)("th",{className:"p-2",children:"Paid"}),(0,l.jsx)("th",{className:"p-2",children:"Actions"})]})}),(0,l.jsx)("tbody",{children:0===n.length?(0,l.jsx)("tr",{children:(0,l.jsx)("td",{colSpan:8,className:"text-center p-4 text-gray-500",children:"No invoices found."})}):n.map(e=>(0,l.jsxs)("tr",{className:"border-b",children:[(0,l.jsx)("td",{className:"p-2",children:e.auctionTitle}),(0,l.jsx)("td",{className:"p-2",children:e.lotNumber}),(0,l.jsx)("td",{className:"p-2",children:e.item}),(0,l.jsxs)("td",{className:"p-2 font-bold text-green-700",children:["R",e.amount.toFixed(2)]}),(0,l.jsx)("td",{className:"p-2",children:e.buyerEmail}),(0,l.jsx)("td",{className:"p-2",children:e.sellerEmail}),(0,l.jsxs)("td",{className:"p-2",children:[(0,l.jsx)("input",{type:"checkbox",checked:!!e.paid,onChange:async()=>{if(!e.paid)try{if(!(await fetch("".concat("http://localhost:5000/api","/invoices/").concat(e.id,"/paid"),{method:"PUT",headers:{"Content-Type":"application/json"}})).ok)throw Error("Failed to update");s(s=>s.map(s=>s.id===e.id?{...s,paid:!0}:s)),d(s=>s.map(s=>s.id===e.id?{...s,paid:!0}:s))}catch(e){alert("Failed to mark as paid.")}}}),(0,l.jsx)("span",{className:e.paid?"text-green-700 ml-2":"text-red-500 ml-2",children:e.paid?"Paid":"Unpaid"})]}),(0,l.jsx)("td",{className:"p-2",children:(0,l.jsx)("button",{className:"text-blue-600 underline text-xs",onClick:()=>o(e),children:"View"})})]},e.id))})]})}),c&&(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-8 max-w-md w-full relative",children:[(0,l.jsx)("button",{className:"absolute top-2 right-2 text-gray-500 hover:text-gray-800 text-xl",onClick:()=>o(null),children:"\xd7"}),(0,l.jsx)("h2",{className:"text-2xl font-bold mb-4 text-yellow-700",children:"Invoice Details"}),(0,l.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("b",{children:"Auction:"})," ",c.auctionTitle]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("b",{children:"Lot:"})," ",c.lotNumber]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("b",{children:"Item:"})," ",c.item]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("b",{children:"Buyer:"})," ",c.buyerEmail]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("b",{children:"Seller:"})," ",c.sellerEmail]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("b",{children:"Date:"})," ",new Date(c.date).toLocaleString()]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("b",{children:"Base Amount:"})," R",c.baseAmount.toFixed(2)]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("b",{children:"Buyer Total:"})," ",(0,l.jsxs)("span",{className:"text-green-700 font-bold",children:["R",c.amount.toFixed(2)]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("b",{children:"Seller Net:"})," ",(0,l.jsxs)("span",{className:"text-blue-700 font-bold",children:["R",c.sellerNet.toFixed(2)]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("b",{children:"Status:"})," ",c.paid?(0,l.jsx)("span",{className:"text-green-700",children:"Paid"}):(0,l.jsx)("span",{className:"text-red-500",children:"Unpaid"})]})]}),(0,l.jsxs)("div",{className:"mt-6 flex gap-4",children:[(0,l.jsx)("button",{className:"px-4 py-2 rounded font-semibold ".concat(c.paid?"bg-gray-400 text-white":"bg-green-600 text-white hover:bg-green-700"),disabled:c.paid,onClick:async()=>{if(!c.paid)try{if(!(await fetch("".concat("http://localhost:5000/api","/invoices/").concat(c.id,"/paid"),{method:"PUT",headers:{"Content-Type":"application/json"}})).ok)throw Error("Failed to update");s(e=>e.map(e=>e.id===c.id?{...e,paid:!0}:e)),d(e=>e.map(e=>e.id===c.id?{...e,paid:!0}:e)),o(e=>e?{...e,paid:!0}:e)}catch(e){alert("Failed to mark as paid.")}},children:"Mark as Paid"}),(0,l.jsx)("button",{className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>o(null),children:"Close"})]})]})})]})})]})}}},e=>{e.O(0,[874,441,964,358],()=>e(e.s=5704)),_N_E=e.O()}]);