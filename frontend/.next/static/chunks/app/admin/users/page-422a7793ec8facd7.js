(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[733],{2572:(e,s,a)=>{"use strict";a.d(s,{A:()=>i});var t=a(5155),n=a(6874),l=a.n(n),r=a(5695);let c=[{href:"/admin/dashboard",label:"Dashboard"},{href:"/admin/auctions",label:"Auctions"},{href:"/admin/lots",label:"Lots"},{href:"/admin/users",label:"Users"},{href:"/admin/invoices",label:"Invoices"},{href:"/admin/assign-seller",label:"Assign Seller"}];function i(){let e=(0,r.usePathname)();return(0,t.jsxs)("aside",{className:"bg-yellow-100 border-r border-yellow-300 min-h-screen w-56 p-6 flex flex-col gap-4 sticky top-0",children:[(0,t.jsx)("h2",{className:"text-lg font-bold text-yellow-700 mb-4",children:"Admin Panel"}),(0,t.jsx)("nav",{className:"flex flex-col gap-2",children:c.map(s=>(0,t.jsx)(l(),{href:s.href,className:"px-3 py-2 rounded font-semibold transition-all text-yellow-800 hover:bg-yellow-200 ".concat(e===s.href?"bg-yellow-300":""),children:s.label},s.href))})]})}},3910:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>c});var t=a(5155),n=a(2115),l=a(2572);function r(){let[e,s]=(0,n.useState)("checking");return(0,n.useEffect)(()=>{fetch("".concat("http://localhost:5000/api","/ping")).then(e=>e.ok?s("ok"):s("fail")).catch(()=>s("fail"))},[]),(0,t.jsxs)("div",{className:"mb-2 text-xs",children:["Backend status: ","checking"===e?"Checking...":"ok"===e?"\uD83D\uDFE2 Connected":"\uD83D\uDD34 Not reachable"]})}function c(){let[e,s]=(0,n.useState)([]),[a,c]=(0,n.useState)([]),[i,o]=(0,n.useState)("");(0,n.useEffect)(()=>{d(),h()},[]);let d=async()=>{let e=await fetch("".concat("http://localhost:5000/api","/users"));s(await e.json())},h=async()=>{let e=await fetch("".concat("http://localhost:5000/api","/auctions"));c(await e.json())},u=async(e,s)=>{await fetch("".concat("http://localhost:5000/api","/users/suspend/").concat(encodeURIComponent(e)),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({suspended:!s})}),await d(),d()},p=async e=>{await fetch("".concat("http://localhost:5000/api","/users/fica/").concat(encodeURIComponent(e)),{method:"PUT",headers:{"Content-Type":"application/json"}}),d()},m=async(e,s,a)=>{o(e+s+a),await fetch("".concat("http://localhost:5000/api","/deposits/return"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,auctionId:s,status:a})}),o(""),d()},x=async e=>{window.confirm("Are you sure you want to delete this user? This cannot be undone.")&&(await fetch("".concat("http://localhost:5000/api","/users/").concat(encodeURIComponent(e)),{method:"DELETE"}),d())};return(0,t.jsxs)("div",{className:"flex min-h-screen",children:[(0,t.jsx)(l.A,{}),(0,t.jsxs)("main",{className:"flex-1 p-6 max-w-5xl mx-auto",children:[(0,t.jsx)(r,{}),(0,t.jsx)("h1",{className:"text-3xl font-bold mb-6 text-yellow-600",children:"User Management"}),0===e.length?(0,t.jsx)("p",{children:"No users found."}):(0,t.jsxs)("table",{className:"w-full border text-sm",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"bg-gray-100 text-left text-xs uppercase",children:[(0,t.jsx)("th",{className:"p-2",children:"Name"}),(0,t.jsx)("th",{className:"p-2",children:"Username"}),(0,t.jsx)("th",{className:"p-2",children:"Email"}),(0,t.jsx)("th",{className:"p-2",children:"Role"}),(0,t.jsx)("th",{className:"p-2",children:"FICA"}),(0,t.jsx)("th",{className:"p-2",children:"Suspended"}),(0,t.jsx)("th",{className:"p-2",children:"Deposit Status"}),(0,t.jsx)("th",{className:"p-2",children:"Actions"}),(0,t.jsx)("th",{className:"p-2",children:"Delete"})]})}),(0,t.jsx)("tbody",{children:e.map(e=>(0,t.jsxs)("tr",{className:"border-t",children:[(0,t.jsx)("td",{className:"p-2",children:e.name}),(0,t.jsx)("td",{className:"p-2",children:e.username||"-"}),(0,t.jsx)("td",{className:"p-2",children:e.email}),(0,t.jsx)("td",{className:"p-2",children:e.role||"user"}),(0,t.jsx)("td",{className:"p-2",children:e.ficaApproved?(0,t.jsx)("span",{className:"text-green-600 font-semibold",children:"Approved"}):e.idDocument||e.proofOfAddress?(0,t.jsxs)(t.Fragment,{children:[e.idDocument&&(0,t.jsx)("a",{href:"/uploads/fica/".concat(e.idDocument),target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 underline mr-2",children:"ID"}),e.proofOfAddress&&(0,t.jsx)("a",{href:"/uploads/fica/".concat(e.proofOfAddress),target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 underline mr-2",children:"Proof"}),(0,t.jsx)("button",{onClick:()=>p(e.email),className:"ml-2 px-2 py-1 text-xs bg-green-500 text-white rounded",children:"Approve"})]}):(0,t.jsx)("span",{className:"text-gray-500",children:"No File"})}),(0,t.jsx)("td",{className:"p-2",children:e.suspended?"Yes":"No"}),(0,t.jsx)("td",{className:"p-2",children:0===a.length?(0,t.jsx)("span",{className:"text-gray-400",children:"No auctions"}):(0,t.jsx)("div",{className:"space-y-1",children:a.map(s=>{var a;let n=null==(a=e.deposits)?void 0:a.find(e=>e.auctionId===s.id);return(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)("span",{className:"font-semibold text-xs",children:[s.title,":"]}),(0,t.jsxs)("span",{className:"text-xs",children:[(null==n?void 0:n.status)==="paid"&&"Paid",(null==n?void 0:n.status)==="return_in_progress"&&"Return in Progress",(null==n?void 0:n.status)==="returned"&&"Returned",!n&&"Not Paid"]}),n&&"paid"===n.status&&(0,t.jsx)("button",{className:"px-2 py-1 text-xs bg-yellow-500 text-white rounded disabled:opacity-50",disabled:i===e.email+s.id+"in_progress",onClick:()=>m(e.email,s.id,"in_progress"),children:"Mark Return In Progress"}),n&&"return_in_progress"===n.status&&(0,t.jsx)("button",{className:"px-2 py-1 text-xs bg-green-600 text-white rounded disabled:opacity-50",disabled:i===e.email+s.id+"returned",onClick:()=>m(e.email,s.id,"returned"),children:"Mark as Returned"})]},s.id)})})}),(0,t.jsx)("td",{className:"p-2",children:(0,t.jsxs)("label",{className:"inline-flex items-center cursor-pointer",children:[(0,t.jsx)("input",{type:"checkbox",checked:!!e.suspended,onChange:async a=>{await u(e.email,e.suspended),s(s=>s.map(s=>s.email===e.email?{...s,suspended:!e.suspended}:s))},className:"sr-only peer"}),(0,t.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-yellow-400 rounded-full peer peer-checked:bg-blue-500 transition-all"}),(0,t.jsx)("span",{className:"ml-2 text-xs font-medium text-gray-700",children:e.suspended?"Suspended":"Active"})]})}),(0,t.jsx)("td",{className:"p-2",children:(0,t.jsx)("button",{onClick:()=>x(e.email),className:"px-2 py-1 text-xs bg-red-600 text-white rounded hover:bg-red-700",children:"Delete"})})]},e.email))})]})]})]})}},5695:(e,s,a)=>{"use strict";var t=a(8999);a.o(t,"useParams")&&a.d(s,{useParams:function(){return t.useParams}}),a.o(t,"usePathname")&&a.d(s,{usePathname:function(){return t.usePathname}}),a.o(t,"useRouter")&&a.d(s,{useRouter:function(){return t.useRouter}}),a.o(t,"useSearchParams")&&a.d(s,{useSearchParams:function(){return t.useSearchParams}})},9090:(e,s,a)=>{Promise.resolve().then(a.bind(a,3910))}},e=>{e.O(0,[874,441,964,358],()=>e(e.s=9090)),_N_E=e.O()}]);